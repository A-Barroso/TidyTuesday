draw_label("Alabama: $7.838259", x= 0.140, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.838259", x= 1, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.838259", x= 1.5, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.838259", x= 0.140, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.838259", x= 0.3, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.838259", x= 0.5, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.838259", x= 0.140, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.838259", x= 0.5, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.838259", x= 0.7, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.838259", x= 0.140, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.838259", x= 0.6, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.838259", x= 0.9, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.838259", x= 0.140, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.838259", x= 0.53, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.838259", x= 0.9, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.838259", x= 0.140, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.838259", x= 0.55, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.838259", x= 0.9, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.838259", x= 0.140, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.838259", x= 0.56, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.838259", x= 0.9, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.838259", x= 0.137, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.838259", x= 0.56, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.838259", x= 0.9, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.838259", x= 0.136, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.838259", x= 0.56, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.838259", x= 0.9, y = 0.725, colour = "#AC7B84", size = 10)
View(kids.total)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.838259", x= 0.136, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.875141", x= 0.56, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.875141", x= 0.9, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.838259", x= 0.136, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.875141", x= 0.56, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.875141", x= 0.8, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.838259", x= 0.136, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.875141", x= 0.56, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.875141", x= 0.85, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.838259", x= 0.136, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.875141", x= 0.56, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.875141", x= 0.86, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.136, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.56, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.86, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.134, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.54, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.87, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.135, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.54, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.87, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.1345, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.54, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.87, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.134, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.54, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.87, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.133, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.54, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.87, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.132, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.55, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.87, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.130, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.55, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.87, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.129, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.55, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.87, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.128, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.55, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.87, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.127, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.55, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.87, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.55, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.87, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.555, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.87, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.87, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10)
kids.total$state <- as.numeric(kids.total$state)
is.numeric(kids.total$state)
p <- ggplot(kids.total, aes(x = total, y = state)) +
geom_point(colour = "#AC7B84", size = 2) +
geom_vline(xintercept = 6.3, colour = "grey75") + ### most states below this
scale_x_continuous(labels = comma) +
coord_flip() +
theme_minimal() +
labs(title = "State Spending on Social Security",  ### DO BETTER
subtitle = "Total expenditure per child by American state, 1997-2016.",
x ="Expenditure in USD", y = "State",
caption = "@ABarroso_BA | Source: tidykids R Package | #TidyTuesday Week 38") +
theme(plot.margin = margin(30,30,15,30),
panel.grid.major = element_line(size = 0.3, colour = "#EFE6E8"),
panel.grid.minor = element_line(size = 0.3, colour = "#EFE6E8"),
axis.text.x = element_text(family = "AdobeFanHeitiStd-Bold", size = 9, angle = 70, vjust = 1, hjust=1),
axis.title.x = element_blank(),
axis.title.y = element_text(family = "AdobeFanHeitiStd-Bold", colour = "grey35", face = "bold", size = 9, margin = margin(0, 20, 0, 0)),
plot.background = element_rect(fill = "#F8F6F1"),
plot.title = element_text(family = "Britannic Bold", colour = "#AC7B84", size = 34, margin = margin(20, 0, 10, 0)),
plot.subtitle = element_text(family = "AdobeFanHeitiStd-Bold", colour = "grey35", size = 16, face = "bold", margin = margin(0, 0, 30, 0)),
plot.caption = element_text(colour = "grey30", family = "AdobeFanHeitiStd-Bold", size = 8, hjust = 1, vjust = -1))
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10)
setwd("C:/Users/Nutzer/Desktop/MSc/R/Projects")
library(tidyverse)
library(extrafont)
library(cowplot)
warnings()
library(scales)
library(ggtext)
kids <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-15/kids.csv')
kids.total <- kids %>%
filter(variable == "socsec") %>%
group_by(state) %>%
select(-raw, -inf_adj) %>%
summarise(total = sum(inf_adj_perchild))
p <- ggplot(kids.total, aes(x = total, y = state)) +
geom_point(colour = "#AC7B84", size = 2) +
geom_vline(xintercept = 6.3, colour = "grey75") + ### most states below this
scale_x_continuous(labels = comma) +
coord_flip() +
theme_minimal() +
labs(title = "State Spending on Social Security",  ### DO BETTER
subtitle = "Total expenditure per child by American state, 1997-2016.",
x ="Expenditure in USD", y = "State",
caption = "@ABarroso_BA | Source: tidykids R Package | #TidyTuesday Week 38") +
theme(plot.margin = margin(30,30,15,30),
panel.grid.major = element_line(size = 0.3, colour = "#EFE6E8"),
panel.grid.minor = element_line(size = 0.3, colour = "#EFE6E8"),
axis.text.x = element_text(family = "AdobeFanHeitiStd-Bold", size = 9, angle = 70, vjust = 1, hjust=1),
axis.title.x = element_blank(),
axis.title.y = element_text(family = "AdobeFanHeitiStd-Bold", colour = "grey35", face = "bold", size = 9, margin = margin(0, 20, 0, 0)),
plot.background = element_rect(fill = "#F8F6F1"),
plot.title = element_text(family = "Britannic Bold", colour = "#AC7B84", size = 34, margin = margin(20, 0, 10, 0)),
plot.subtitle = element_text(family = "AdobeFanHeitiStd-Bold", colour = "grey35", size = 16, face = "bold", margin = margin(0, 0, 30, 0)),
plot.caption = element_text(colour = "grey30", family = "AdobeFanHeitiStd-Bold", size = 8, hjust = 1, vjust = -1))
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.1, y = 0.725, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.1, y = 0.225, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.1, y = 0.125, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.6, y = 0.9, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.9, y = 0.9, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.8, y = 0.9, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.8, y = 0.9, face = "bold", colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.8, y = 0.9, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.86, y = 0.8, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.86, y = 0.87, colour = "#AC7B84", size = 10)
p <- ggplot(kids.total, aes(x = total, y = state)) +
geom_point(colour = "#AC7B84", size = 2) +
geom_vline(xintercept = 6.3, colour = "grey75") + ### most states below this
scale_x_continuous(labels = comma) +
coord_flip() +
theme_minimal() +
labs(title = "State Spending on Social Security",  ### DO BETTER
subtitle = "Total expenditure per child by American state, 1997-2016.",
x ="Expenditure in USD", y = "State",
caption = "@ABarroso_BA | Source: tidykids R Package | #TidyTuesday Week 38") +
theme(plot.margin = margin(30,30,15,30),
panel.grid.major = element_line(size = 0.3, colour = "#EFE6E8"),
panel.grid.minor = element_line(size = 0.3, colour = "#EFE6E8"),
axis.text.x = element_text(family = "AdobeFanHeitiStd-Bold", size = 9, angle = 70, vjust = 1, hjust=1),
axis.title.x = element_blank(),
axis.title.y = element_text(family = "AdobeFanHeitiStd-Bold", colour = "grey35", face = "bold", size = 9, margin = margin(0, 20, 0, 0)),
plot.background = element_rect(fill = "#F8F6F1"),
plot.title = element_text(family = "Britannic Bold", colour = "#AC7B84", size = 34, margin = margin(20, 0, 10, 0)),
plot.subtitle = element_text(family = "AdobeFanHeitiStd-Bold", colour = "grey35", size = 16, face = "bold", margin = margin(0, 0, 30, 0)),
plot.caption = element_text(colour = "grey30", family = "AdobeFanHeitiStd-Bold", size = 8, hjust = 1, vjust = -1, margin = margin(0, 0, 10, 0)))
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.86, y = 0.87, colour = "#AC7B84", size = 10)
p <- ggplot(kids.total, aes(x = total, y = state)) +
geom_point(colour = "#AC7B84", size = 2) +
geom_vline(xintercept = 6.3, colour = "grey75") + ### most states below this
scale_x_continuous(labels = comma) +
coord_flip() +
theme_minimal() +
labs(title = "State Spending on Social Security",  ### DO BETTER
subtitle = "Total expenditure per child by American state, 1997-2016.",
x ="Expenditure in USD", y = "State",
caption = "@ABarroso_BA | Source: tidykids R Package | #TidyTuesday Week 38") +
theme(plot.margin = margin(30,30,15,30),
panel.grid.major = element_line(size = 0.3, colour = "#EFE6E8"),
panel.grid.minor = element_line(size = 0.3, colour = "#EFE6E8"),
axis.text.x = element_text(family = "AdobeFanHeitiStd-Bold", size = 9, angle = 70, vjust = 1, hjust=1),
axis.title.x = element_blank(),
axis.title.y = element_text(family = "AdobeFanHeitiStd-Bold", colour = "grey35", face = "bold", size = 9, margin = margin(0, 20, 0, 0)),
plot.background = element_rect(fill = "#F8F6F1"),
plot.title = element_text(family = "Britannic Bold", colour = "#AC7B84", size = 34, margin = margin(20, 0, 10, 0)),
plot.subtitle = element_text(family = "AdobeFanHeitiStd-Bold", colour = "grey35", size = 16, face = "bold", margin = margin(0, 0, 30, 0)),
plot.caption = element_text(colour = "grey30", family = "AdobeFanHeitiStd-Bold", size = 8, hjust = 1, vjust = -1, margin = margin(0, 0, 20, 0)))
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.86, y = 0.87, colour = "#AC7B84", size = 10)
p <- ggplot(kids.total, aes(x = total, y = state)) +
geom_point(colour = "#AC7B84", size = 2) +
geom_vline(xintercept = 6.3, colour = "grey75") + ### most states below this
scale_x_continuous(labels = comma) +
coord_flip() +
theme_minimal() +
labs(title = "State Spending on Social Security",  ### DO BETTER
subtitle = "Total expenditure per child by American state, 1997-2016.",
x ="Expenditure in USD", y = "State",
caption = "@ABarroso_BA | Source: tidykids R Package | #TidyTuesday Week 38") +
theme(plot.margin = margin(30,30,15,30),
panel.grid.major = element_line(size = 0.3, colour = "#EFE6E8"),
panel.grid.minor = element_line(size = 0.3, colour = "#EFE6E8"),
axis.text.x = element_text(family = "AdobeFanHeitiStd-Bold", size = 9, angle = 70, vjust = 1, hjust=1),
axis.title.x = element_blank(),
axis.title.y = element_text(family = "AdobeFanHeitiStd-Bold", colour = "grey35", face = "bold", size = 9, margin = margin(0, 20, 0, 0)),
plot.background = element_rect(fill = "#F8F6F1"),
plot.title = element_text(family = "Britannic Bold", colour = "#AC7B84", size = 34, margin = margin(20, 0, 10, 0)),
plot.subtitle = element_text(family = "AdobeFanHeitiStd-Bold", colour = "grey35", size = 16, face = "bold", margin = margin(0, 0, 30, 0)),
plot.caption = element_text(colour = "grey30", family = "AdobeFanHeitiStd-Bold", size = 8, hjust = 1, vjust = -1, margin = margin(0, 0, 13, 0)))
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.86, y = 0.87, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.1, y = 0.2, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.86, y = 0.87, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.1, y = 0.2, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.2, y = 0.1, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.2, y = -0.1, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.2, y = 0.05, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.15, y = 0.05, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.17, y = 0.05, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.19, y = 0.05, colour = "#AC7B84", size = 10)
ggdraw() +
draw_plot(p) +
geom_smooth(method = "lm") +
draw_label("Alabama: $7.84*", x= 0.126, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("Mississippi: $7.88*", x= 0.553, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("West Virginia: $7.88*", x= 0.875, y = 0.725, colour = "#AC7B84", size = 10) +
draw_label("*Figures have been rounded to two decimal points.", x= 0.185, y = 0.05, colour = "#AC7B84", size = 10)
setwd("C:/Users/Nutzer/Desktop/MSc/R/Projects/TidyTuesday/Scripts")
library(tidyverse)
library(extrafont)
library(cowplot)
friends_emotions <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-08/friends_emotions.csv')
friends.clean <- friends_emotions %>%
select(-episode, -scene, -utterance) %>%
mutate(
season = case_when(
season == "1" ~ "Season 1",
season == "2" ~ "Season 2",
season == "3" ~ "Season 3",
season == "4" ~ "Season 4")
) %>%
group_by(season) %>%
count(emotion)
friends_info <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-08/friends_info.csv')
f_info.clean <- friends_info %>%
select(season, imdb_rating) %>%
group_by(season)
font_import(path = "C:/Users/Nutzer/AppData/Local/Microsoft/Windows/Fonts")
img <- "https://pbs.twimg.com/media/EhfwFiEWAAIVEsL?format=png&name=4096x4096"
friends.clean$emotion <- as.factor(friends.clean$emotion)
friends.clean$emotion <- factor(friends.clean$emotion, levels = c("Joyful",
"Mad",
"Peaceful",
"Sad",
"Powerful",
"Scared",
"Neutral"))
p <- ggplot(friends.clean, aes(emotion, n, fill = emotion)) +
geom_col() +
coord_polar(theta = "y", clip = "off") +
theme_minimal() +
facet_wrap(~ season, nrow = 1) +
labs(title = "Friend : An Emotional Rollercoaster",
subtitle = "Aggregated emotional values per season",
caption = "@ABarroso_BA | Source: friends R Package | #TidyTuesday Week 37") +
scale_fill_manual(values = c("#F74035", "#9787CD", "#3F9DD4", "#008F48", "#F6D400", "#DF4013", "#941205")) +
guides(fill = guide_legend(nrow = 1, override.aes = list(size = 2))) +
theme(text = element_text(family = "GabrielWeissFriendsFont"),
plot.margin = margin(20,20,30,20),
legend.position = "bottom",
legend.margin = margin(25, 0, 15, 0),
legend.title = element_blank(),
legend.text = element_text(colour = "grey97"),
strip.text = element_text(colour = 'grey97'),
panel.grid.major = element_line(size = 0.3, colour = "grey10"),
panel.grid.minor = element_line(size = 0.3, colour = "grey10"),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.background = element_rect(fill = "#000000"),
plot.title = element_text(family = "Gabriel Weiss' Friends Font", size = 28, face ="bold", colour = "grey97", hjust = 0.90, vjust = 2, margin = margin(20, 0, 10, 0)),
plot.subtitle = element_text(size = 16, colour = "grey97", hjust = 0.5, margin = margin(0, 0, 30, 0)),
plot.caption = element_text(size = 8, colour = "grey97", hjust = 0.5, vjust = 2))
ggdraw() +
draw_plot(p) +
draw_image(img, scale=0.30, y=0.325, x=-0.305) +
draw_label("Mean IMDb Rating: 8.20", x= 0.145, y = 0.271, colour = "white", size = 10) +
draw_label("Mean IMDb Rating: 8.45", x= 0.38, y = 0.271, colour = "white", size = 10) +
draw_label("Mean IMDb Rating: 8.30", x= 0.62, y = 0.271, colour = "white", size = 10) +
draw_label("Mean IMDb Rating: 8.50", x= 0.855, y = 0.271, colour = "white", size = 10)
ggsave("TidyTuesdayW37.tiff", plot = last_plot(), dpi = 400, height = 180, width = 280, units = "mm")
